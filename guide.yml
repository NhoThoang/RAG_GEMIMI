rong Ä‘oáº¡n code FastAPI cá»§a báº¡n, cÃ³ 4 mÃ´ hÃ¬nh (models) Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng tá»« cÃ¡c thÆ° viá»‡n sentence-transformers, transformers, vÃ  google.generativeai. Cá»¥ thá»ƒ nhÆ° sau:

âœ… 1. SentenceTransformer("intfloat/multilingual-e5-base")
ThÆ° viá»‡n: sentence-transformers

Má»¥c Ä‘Ã­ch: DÃ¹ng Ä‘á»ƒ táº¡o vector embedding cho Ä‘oáº¡n vÄƒn vÃ  cÃ¢u há»i.

Thiáº¿t bá»‹ cháº¡y: GPU hoáº·c CPU (qua device=device_str)

á»¨ng dá»¥ng trong code:

model.encode(chunk) Ä‘á»ƒ vector hÃ³a Ä‘oáº¡n chunk tÃ³m táº¯t

model.encode(question) Ä‘á»ƒ vector hÃ³a cÃ¢u há»i cá»§a ngÆ°á»i dÃ¹ng

So sÃ¡nh ngá»¯ nghÄ©a báº±ng cosine similarity

âœ… 2. pipeline("summarization", model="facebook/bart-large-cnn")
ThÆ° viá»‡n: transformers

Má»¥c Ä‘Ã­ch: TÃ³m táº¯t vÄƒn báº£n (text summarization)

Thiáº¿t bá»‹ cháº¡y: GPU náº¿u torch.cuda.is_available(), qua device=device

á»¨ng dá»¥ng trong code:

Trong summarize_text(), dÃ¹ng Ä‘á»ƒ táº¡o tÃ³m táº¯t cho má»—i Ä‘oáº¡n chunk PDF

âœ… 3. pipeline("text2text-generation", model="google/flan-t5-base")
ThÆ° viá»‡n: transformers

Má»¥c Ä‘Ã­ch: Sinh tiÃªu Ä‘á» ngáº¯n cho Ä‘oáº¡n chunk

Thiáº¿t bá»‹ cháº¡y: GPU náº¿u cÃ³

á»¨ng dá»¥ng trong code:

Trong generate_title(), sinh tiÃªu Ä‘á» cho má»—i chunk

âœ… 4. genai.GenerativeModel("gemini-pro") â† ğŸŸ¥ SAI MODEL NAME
ThÆ° viá»‡n: google.generativeai

Má»¥c Ä‘Ã­ch: DÃ¹ng Gemini API (Google) Ä‘á»ƒ sinh cÃ¢u tráº£ lá»i tá»•ng há»£p tá»« cÃ¡c chunk tÃ¬m Ä‘Æ°á»£c

Model name Ä‘Ãºng pháº£i lÃ :

python
Copy
Edit
genai.GenerativeModel("models/gemini-pro")
á»¨ng dá»¥ng trong code:

Trong generate_answer(), sinh ra cÃ¢u tráº£ lá»i tá»•ng há»£p tá»« top 5 chunk tÃ¬m Ä‘Æ°á»£c 


| TÃªn model                       | Má»¥c Ä‘Ã­ch                  | Nguá»“n model           | Cháº¡y trÃªn | Ghi chÃº                                          |
| ------------------------------- | ------------------------- | --------------------- | --------- | ------------------------------------------------ |
| `intfloat/multilingual-e5-base` | Vector hÃ³a ngá»¯ nghÄ©a      | sentence-transformers | GPU/CPU   | DÃ¹ng cho search Qdrant vÃ  chunking               |
| `facebook/bart-large-cnn`       | TÃ³m táº¯t vÄƒn báº£n           | transformers          | GPU/CPU   | CÃ³ thá»ƒ thay báº±ng model nháº¹ hÆ¡n                   |
| `google/flan-t5-base`           | Sinh tiÃªu Ä‘á»              | transformers          | GPU/CPU   | Text2Text Generation                             |
| `models/gemini-pro`             | Sinh cÃ¢u tráº£ lá»i báº±ng API | Google Gemini API     | Cloud API | Cáº§n sá»­a láº¡i `"gemini-pro"` â†’ `models/gemini-pro` |



âœ… CÃ¡ch gá»i API /ask (POST)
ğŸ“¤ Request khi cÃ¢u há»i má»›i:
json
Copy
Edit
POST /ask
{
  "question": "Cuá»‘n sÃ¡ch nÃ³i vá» Ä‘iá»u gÃ¬?",
  "type": "new"
}
ğŸ“¤ Request khi lÃ  há»™i thoáº¡i tiáº¿p ná»‘i:
json
Copy
Edit
POST /ask
{
  "question": "Ã”ng áº¥y sinh nÄƒm bao nhiÃªu?",
  "type": "followup",
  "history": [
    {"question": "NhÃ¢n váº­t chÃ­nh lÃ  ai?", "answer": "Ã”ng áº¥y lÃ  Nguyá»…n VÄƒn A."}
  ]
}


{
  "question": "Bill Gates tá»«ng phÃ¡t biá»ƒu gÃ¬ vá» giÃ¡o dá»¥c?",
  "type": "followup",
  "history": [
    {
      "question": "Bill Gates lÃ  ai?",
      "answer": "Bill Gates lÃ  nhÃ  sÃ¡ng láº­p Microsoft, sinh nÄƒm 1955..."
    },
    {
      "question": "Ã”ng cÃ³ vai trÃ² gÃ¬ trong ngÃ nh cÃ´ng nghá»‡?",
      "answer": "Ã”ng lÃ  ngÆ°á»i tiÃªn phong Ä‘Æ°a mÃ¡y tÃ­nh cÃ¡ nhÃ¢n Ä‘áº¿n má»i ngÆ°á»i..."
    }
  ]
}
